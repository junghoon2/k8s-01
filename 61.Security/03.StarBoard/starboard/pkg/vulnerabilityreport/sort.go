package vulnerabilityreport

import (
	"github.com/aquasecurity/starboard/pkg/apis/aquasecurity/v1alpha1"
)

type Vulnerabilities []v1alpha1.Vulnerability

func (s Vulnerabilities) Len() int { return len(s) }

func (s Vulnerabilities) Swap(i, j int) { s[i], s[j] = s[j], s[i] }

// BySeverity implements sort.Interface by providing Less and using the
// Vulnerabilities.Len and Vulnerabilities.Swap methods of the embedded
// Vulnerabilities value.
type BySeverity struct{ Vulnerabilities }

var severityOrder = map[v1alpha1.Severity]int{
	v1alpha1.SeverityCritical: 0,
	v1alpha1.SeverityHigh:     1,
	v1alpha1.SeverityMedium:   2,
	v1alpha1.SeverityLow:      3,
	v1alpha1.SeverityUnknown:  4,
}

func (s BySeverity) Less(i, j int) bool {
	return severityOrder[s.Vulnerabilities[i].Severity] < severityOrder[s.Vulnerabilities[j].Severity]
}
